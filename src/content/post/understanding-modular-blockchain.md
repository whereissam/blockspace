---
publishDate: 2024-03-09T00:00:00Z
author: Sam
title: 一文理解什麼是模塊化區塊鏈
excerpt: 這篇文章將介紹模塊化區塊鏈的核心，有助於理解往後看到新冒出來的解決方案
image: https://replicate.delivery/pbxt/PP2hM6WetX3gMqcfeyHnFDkLA2C7t8DOXn0pJiX1f88NQx5JB/out-0.png
category: Blockchain
tags:
  - 模塊化區塊鏈
metadata:
  canonical: https://astrowind.vercel.app/astrowind-template-in-depth
---




## 背景補充

在最早的時候，區塊鏈的設計就是單片式區塊鏈，可以把想像成旅行社幫你規劃好的行程，裡面的內容都是綁死也不能更改．單片式區塊鏈按照功能可以區分為共識層、數據可用性層、執行層和結算層，，這些功能都會由一條鏈承擔，那麼隨着交易和需求的增多，單鏈節點承擔的壓力也越多，性能會越差，或者稱爲狀態膨脹。與單鏈不同，模塊化區塊鏈就是把這些層進行拆解，將至少一個功能層完全外包給其他鏈，實現專用性和可組合性。比如下面要介紹的模塊化區塊鏈 celestia 就只做共識和 DA 層


### 目前區塊鏈碰到的問題

在認識模組化區塊鏈需要先前情提要，目前區塊鏈有不可能的三角，區塊鏈技術在安全性、去中心化和可擴展性三個方面無法同時達到最優
- 安全性 : 不容易被攻擊或篡改的程度
- 去中心化 : 不受任何單一實體控制的程度，舉例銀行
- 可擴展性 : 能夠處理交易的速度和效率

傳統的區塊鏈架構是比較單一的，所有的功能都集中在一個主鏈上。這樣做雖然可以確保區塊鏈的安全性和去中心化，但也會犧牲可擴展性。因此會常常看到網路壅塞導致的 gas fee 的上升或是交易傳不出去

例如，比特幣鏈採用的工作量證明（PoW）共識機制，需要大量節點參與計算，以確保區塊鏈的安全性和去中心化。然而，PoW 共識機制也需要消耗大量的計算資源和能源，從而影響區塊鏈的可擴展性。

這時候就有人跳出來要去解決這個問題，就是模組化區塊鏈


## 模組化區塊鏈
### 什麼是模組化區塊鏈

想像一下，在區塊鏈做交易跟你去商店交易是一樣的意思，在商店做交易有很多步驟，有一間商店賣你要的東西，看到貨物架上陳列有你的商品，店員幫你結帳，收銀機收你的錢，如果哪一個部分卡住了，整個流程就會卡住，你應該很常去全聯要結帳的時候聽到熟悉的聲音，請支援收銀～～～，回到模組化區塊鏈也是，一個交易的背後有很多步驟，每個步驟都有一個特定的機器幫你處理，既然是都有特定的機器幫你執行，那我們也可以把那些原先混在一起的機器拆開來執行

模組化區塊鏈是指一種區塊鏈設計方法，在傳統區塊鏈中，整個區塊鏈網絡通常被設計為一個單一的、複雜的系統，所有功能和特性都被結合在一起。然而，模組化區塊鏈將區塊鏈的不同組件分解為獨立的模塊或模組，每個模組負責執行特定的任務或提供特定的功能。

這就像是將一個龐大的複雜機器分成更小的、更易管理的部分，每個部分可以單獨操作，也可以根據需要組合在一起。這樣的架構使得開發者能夠更靈活地選擇和定制區塊鏈的各個方面，而不必牽一髮動全身。

因此，模組化區塊鏈可以通過靈活的組合來解決區塊鏈不可能的三角問題。

### 模組化區塊鏈的組成

可以看到這張圖，把區塊鏈的技術再去做更深的扒解，這部分蠻重要的，在之後會常常看到有人針對 DA 層討論或是  Consensus 層做討論

![](https://i.imgur.com/h7k54kL.png)
Source : [万字长文：全面解读新公链新生态](https://zhuanlan.zhihu.com/p/577636629)

- 安全模組：保證區塊鏈的安全性
    - 數據可用性層（Data Availability）：負責存儲區塊鏈上的數據，並使其對輕客戶端可用 
    - 共識層（Consensus）： 負責維護區塊鏈的共識機制，確保區塊鏈的安全和一致性 
- 執行環境層：提供區塊鏈的執行環境
     - 結算層（Settlement）： 負責將交易轉換為更具經濟意義的形式，例如代幣或穩定幣 
     - 執行層（Execution）： 負責處理區塊鏈上的交易和智能合約
    
### 執行層（Execution）

負責處理交易和智能合約。它是區塊鏈可擴展性的主要瓶頸，因為隨著使用量的增加，交易速度會下降，成本會上升(因為 gas fee 提高)，執行層面臨的主要挑戰是可擴展性。隨著區塊鏈的使用量不斷增加，交易數量也會隨之增加。傳統的執行層方案難以滿足不斷增長的交易需求，因此需要新的擴展方案來提高區塊鏈的吞吐量。

#### 執行層的主要功能包括：
- 驗證交易：驗證交易的有效性，防止欺詐和雙重花費
- 執行智能合約：根據智能合約的代碼執行交易
- 更新狀態：更新區塊鏈的狀態，以反映交易的結果

目前，針對執行層的擴展方案主要有兩種：
- 第 1 層擴展：直接在主鏈上進行擴展
    - 提高區塊大小：將區塊的大小從目前的幾 MB 增加到幾十 MB 甚至幾 GB，以提高每秒交易數 (TPS)。然而，這會增加全節點的存儲和計算需求，可能導致中心化(因為符合這樣的電腦越貴，就越少人符合資格)
    - 採用分片技術：將區塊鏈的數據和計算分散到多個分片上，每個分片處理一部分交易。這可以提高吞吐量，但會增加區塊鏈的複雜性
- 第 2 層擴展：在主鏈之上或之外建立輔助網路進行擴展
    - 匯總 (Rollup)：將多筆交易聚合成一個交易，並在主鏈上提交有效性證明，以提高吞吐量和降低成本。目前的解決方案有
        - Arbitrum One
        - Optimism
        - ZkSync
    - 側鏈：建立一個與主鏈並行的獨立區塊鏈，以提高吞吐量。側鏈可以採用不同的共識機制和區塊大小，但需要與主鏈建立安全可靠的橋樑

> 區塊大小是指區塊鏈上的每個區塊所包含的交易數量或數據大小。每個區塊包含一定數量的交易記錄，這些交易被打包成區塊，然後添加到區塊鏈中。區塊大小是以數據量或交易數量來度量的
### 數據可用性層（Data Availability）

數據可用性層的目的是儲存區塊鏈數據並確保網路上的每個人都同意（達成共識）該數據實際上可用


以太坊上的一個區塊，包含區塊頭和區塊體參與的數據節點主要有兩種，全節點下載並驗證所有區塊信息及交易數據容量大，輕節點只驗證區塊頭，減少存儲空間。具體來說，當區塊發佈者發佈一個有效的區塊頭，全節點是無法爲輕節點生成數據可用性證明的，因此輕節點只能依賴區塊頭來驗證。但若區塊體中有隱瞞或無效的交易數據時，就可能引發惡意攻擊，所以輕節點必須需要自己去驗證全節點中的交易數據，來保證數據是可信的。

這就是爲什麼目前像以太坊這種單鏈的做法，就是要對所有數據進行下載驗證，而且隨著使用量的增加，節點需要下載和存儲的數據量也會增加，這樣顯然不利於可擴展性，因此數據可用性問題也是區塊鏈擴展中的主要瓶頸。而在 Rollup 上的所有交易數據都要回傳到以太坊上的數據可用性層，確保數據是可用的，並進行最終的狀態確認。比如 optimistic roll up 採用的 DA 驗證方式爲欺詐證明。將數據打包回傳到以太坊，並先樂觀假設所有數據都是正確的，在經歷 7 天的欺詐證明挑戰期來確定最終數據是否有效。


#### 什麼是數據可用性
數據可用性是指數據完整保留在區塊鏈上且能夠隨時被用戶訪問和查詢的能力

也就是你平常去看你交易的地方 Etherscan, Arbiscan 

當在 Etherscan 上查詢數據時，實際上是在向 Etherscan 的服務器發送請求。 Etherscan 的服務器會從以太坊區塊鏈中獲取數據並將其返回。因此，能夠訪問以太坊區塊鏈數據的能力，實際上是 Etherscan 提供數據可用性的結果。

如果沒有不能夠去讀取的話就會引發很大的問題，用戶無法查詢區塊鏈數據，區塊鏈的安全性和可靠性降低，數據可用性是區塊鏈安全性和可靠性的一個重要保障。如果沒有數據可用性，那麼區塊鏈的安全性和可靠性將降低


#### 數據可用性問題
主要表現在以下幾個方面：
- 數據規模的增長：隨著區塊鏈的使用量增加，數據的規模也會不斷增長。這會給輕節點帶來巨大的存儲和帶寬壓力。
- 數據安全性：數據可用性層需要確保數據的安全性，以防止數據被篡改或刪除。
- 數據成本：數據可用性層的成本需要保持在可接受的範圍內，以鼓勵參與者積極參與。

目前，針對數據可用性層的擴展方案主要有兩種：

- 第 1 層解決方案：直接在主鏈上進行擴展。第 1 層解決方案包括：
    - 採用分片技術：將區塊鏈的數據和計算分散到多個區塊鏈上，可以同時並行處理，以提高吞吐量。
- 第 2 層解決方案：在主鏈之外建立輔助網路進行擴展。第 2 層解決方案包括：
    - 匯總 (Rollup)：將多筆交易聚合成一個交易，並在主鏈上提交有效性證明，以提高吞吐量和降低成本。
    - 側鏈：建立一個與主鏈並行的獨立區塊鏈，以提高吞吐量。

第 1 層解決方案可以直接提高主鏈的性能，但需要對主鏈進行硬分叉或軟分叉，並可能導致安全性和去中心化的降低。第 2 層解決方案可以保留主鏈的安全性和去中心化，但需要在主鏈和第 2 層網路之間建立橋接，並可能導致交易成本增加。

目前，第 2 層解決方案的發展速度較快，並得到了越來越多的應用。例如，以太坊的 Optimism 和 Arbitrum 等匯總方案已經上線，並提供高吞吐量和低成本的交易服務。



### 結算層（Settlement）

區塊鏈的結算層是負責將區塊鏈上的交易最終確認並記錄到分散式帳本的過程。結算層是區塊鏈網路安全和可靠性的另一個基礎

- 安全性：結算層提供生態系內最高等級的安全性。此處驗證和確定的交易被認為是不可逆轉且防篡改的。 
- 最終性：一旦交易在這一層結算，就被認為是最終的並且不能逆轉。這保證了整個生態系的完整性和穩定性。 
- 爭議解決：如果生態系內其他層發生任何分歧或衝突，結算層將作為最終解決機構。

想像一下傳統的證券交易所。交易所本身充當結算層，確保安全和最終的交易。個別交易可能以電子方式或透過其他管道進行，但交易所保證最終結算。

### 共識層（Consensus）

區塊鏈的共識層是負責確保區塊鏈網路中所有節點對區塊鏈數據達到一致共識的過程


不同的區塊鏈使用不同的共識機制，即達成一致的具體協議。以下是兩個流行的例子： 
- 工作量證明 (Proof-of-Work, PoW)：PoW 是目前比特幣使用的機制。在這裡，節點競爭解決複雜的難題，獲勝者可以添加下一個交易區塊。這個過程需要大量的運算能力，使其安全但同時也是能源密集的，存在能源消耗大、交易速度慢等問題。 
- 股權證明 (Proof-of-Stake, PoS)：這是一種更節能的替代方案。參與 PoS 的節點「抵押」他們持有的一些加密貨幣。然後，網路根據其權益選擇驗證者來驗證交易並添加區塊，具有能源消耗小、交易速度快等優點，但也存在安全性較低的問題。


此外還有一些其他的區塊鏈共識層的解決方案：
- 拜占庭容錯 (Byzantine Fault Tolerance, BFT)：BFT 是一種針對拜占庭容錯問題的共識機制。BFT 要求網路中的節點達到一致共識，即使有少數節點故障或惡意行為。BFT 具有較高的安全性，但也存在效率較低的問題。
- 委托權益證明 (Delegated Proof-of-Stake, DPoS)：DPoS 是一種基於 PoS 的共識機制。DPoS 要求節點通過投票選出一個小組的節點作為代表節點，然後由代表節點來生成區塊。DPoS 具有較高的安全性和效率，但也存在中心化的問題。

### 用一些簡單的方式去解釋

當你走進商店購物時，整個採購過程可以類比為區塊鏈的各個層次：
- 共識層： 想像這是商店的管理團隊，他們確保每個購物者的交易都是有效的。就像管理層確保公司的每個決策都是符合公司利益的，共識層確保每個交易都得到確認，防止不當行為。
- 執行層： 執行層就像商店的各個部門，負責實際執行交易，處理商品的購買和交付。在區塊鏈上，執行層處理所有的交易和智能合約，就像商店的各個部門負責自己的業務。
- 數據可用性層： 數據可用性層就像商店的庫房，保存了所有商品的記錄和數據，以便隨時查閱。這確保你和商店都可以方便地獲取所需的信息，就像區塊鏈上的數據對參與者都是可用的。
- 結算層： 結算層就像商店的結帳櫃台，將你購買的商品轉換為總金額。這有助於確保你的購物費用清晰可見，就像商店的結帳櫃台確保商店的財務狀況清晰可見。

透過比較日常化的比喻，希望可以理解
