---
publishDate: 2024-03-08T00:00:00Z
author: Sam
title: 以太坊坎昆升級你必須知道的幾件事
excerpt: 這篇文章將介紹以太坊坎昆升級背後的技術背景和利好的幣種
image: https://replicate.delivery/pbxt/OF9V3HUO52JCFxSin4qvme3BiNWsdQ5biJG1sdaYFtmOnHPJA/out-0.png
category: Blockchain
tags:
  - 以太坊
metadata:
  canonical: https://astrowind.vercel.app/astrowind-template-in-depth
---

---

## 背景補充

坎昆升級是以太坊的一次重要更新，目的是要改進區塊鏈網絡的效能和可擴展性。目前，以太坊生態系統包括主要的第一層（L1）以太坊區塊鏈，以及第二層（L2）解決方案，如 Arbitrum 和 Optimism 等。

以太坊區塊鏈目前面臨一個技術上的限制，也就是不可能的三角，去中心化（Decentralization）、安全性（Security）、可擴展性－效能（Scalability），以太坊知道目前的限制很多，因此有想了幾種方式要去解決，以太坊自身的擴容 Danksharding、L2 rollup 和側鏈的解決方案，以太坊自身的擴容分片技術被視為解決可擴展性問題的重要方案。分片技術的核心思想是將整個以太坊網絡分割為多個獨立的區塊鏈片段，每個片段稱為一個分片。每個分片都有自己的區塊、交易歷史和狀態，能夠獨立處理交易，從而提高整個網絡的吞吐量和性能。

儘管分片技術是被視為最終解決方案，但它需要較長的時間才能實現。因此，許多 L2 的公鏈解決方案因應而生，這些解決方案實際上是建立在以太坊之外的獨立區塊鏈，通過「跨鏈橋」的技術與以太坊主網絡連接，透過資料壓縮的方式降低手續費解決核心的擴展性問題，原先每一筆記錄都要在以太坊上面完成，因此會造成網路壅塞。雖然它們與以太坊區塊鏈相互連接，但它們具有獨立的區塊生成和交易處理能力，進一步提高了整個生態系統的擴展性和效能。

坎昆升級的目標之一是為以太坊的分片技術鋪平道路，為未來的網絡擴展做好準備。透過坎昆升級，以太坊將為 L2 解決方案提供更強大的基礎設施，同時為未來的技術創新打下堅實的基礎，可以從官方的定義看到什麼是 L2

### 什麼是 L2

![image](https://hackmd.io/_uploads/r1yQjyiOa.png)

L2 是在做數據的壓縮，因為目前直接存在以太坊上面的數據太貴，所以才有 L2 做一層捆包，把很多數據打包後送給以太坊，這樣原本每次交易都要上到以太坊鏈上，每次都要付蠻大額的手續費，可以從下圖看到兩者之間的差別，大概就差了幾十倍，可以在[這裡](https://tokentool.bitbond.com/gas-price/ethereum)看更多的交易費的差別

![image](https://hackmd.io/_uploads/HkTuYnBTp.png)

![image](https://hackmd.io/_uploads/r1acF2r6T.png)



但這其實只是單純的交易費，如果再加上要去執行智能合約的複雜度不一樣， 交易費就又會再提升不少，因此 L2 還不是最好的解法

#### L2 怎麼壓縮資料的？

1. 批次：交易被分組到批次處理。這顯著減少了需要在第 1 層儲存的單一交易的數量。想像一下，您只需儲存代表整個批次的單一記錄，而不是儲存數百個交易
2. Rollup diff 壓縮：此技術專注於僅識別和儲存第 2 層系統後續狀態之間的差異。不是在每次交易後儲存整個狀態，而是僅記錄變更。這減少了冗餘並節省了空間。
3. 應用程式級壓縮：根據特定的第 2 層解決方案，可能會在應用程式層級應用其他壓縮技術。這可能涉及自訂資料編碼或利用特定於所處理資料的模式等內容

可以從[這個區塊鏈瀏覽器](https://optimistic.etherscan.io/)看到他實際上是把數據壓縮送到以太坊上面

![image](https://hackmd.io/_uploads/HyMpY1jOa.png)

然而如果目前以太坊要做到這件事情的話本身是沒辦法做到的，需要透過打掉重來才能，因此在最近期的升級是他們做了新的鏈，把舊有的資料移到新的鏈

#### Layer2 背後的技術

現有乙太坊生態主流的 Layer2，其設計架構是將智慧合約的運算需求外包給外部伺服器，最後將結果（欺詐證明或是零知識證明） 交給乙太坊進行結算。

這個伺服器又被稱為排序器（Sequencer），接收來自使用者的無序交易，在鏈外將其處理成組，然後生成一批壓縮的有序交易，再發送到乙太坊，可以說排序器就是 L2 的靈魂。

一個殘酷的事實是，目前目前主流 Layer2 包含 Arbitrum、Optimism 等，目前都是以中心化的排序器在運行網路，原因很簡單，運行自己唯一的中心化排序器最為方便、使用者友好且成本更低。

然而，這既不符合加密貨幣一直標榜的的去中心化精神，另一方面也帶來排序器是否會做惡、插入交易、MEV 等問題。目前很多去中心化的排序氣解決方案因此而出，我會再開一集討論


## 坎昆升級升級了什麼

### 什麼時候要升級

2024 年 3 月 13 日，epoch 高度是 269568，大概台灣的晚上 21 點

### 升級了什麼

![image](https://hackmd.io/_uploads/BkKRMaHTp.png)

總共有五個 EIP 提案通過，其中最重要的是 EIP-4844

### EIP-4844

![image](https://hackmd.io/_uploads/rJZuf6B6p.png)


EIP-4844，也稱為 Proto-Danksharding，是一項以太坊改進提案（EIP），旨在解決以太坊網路的可擴展性問題。由於當前架構的限制，以太坊面臨高交易費用和緩慢的交易處理時間。 

EIP-4844 透過引入一種稱為「blob-carrying transaction」的新型交易，提出了一種擴展以太坊擴容性的技術方案。

過去，L2 會將 100 筆交易打包成一個 rollup 塊，然後將 rollup 塊的哈希值和相關信息存儲在以太坊主網的交易中。這會增加主網的負擔，提高 gas 費用。更新後，L2 仍會將 100 筆交易打包成一個 rollup 塊，但會將 rollup 塊的數據存儲在 blob 裡。blob 裡的數據不佔用主網空間，可以減輕主網的負擔，降低 gas 費用。


EIP-4844 將以太坊的數據分為兩層：
1. 第一層是主網區塊鏈，存儲交易數據的哈希值和相關信息
2. 第二層是 blob 儲存，存儲交易數據本身

blob 儲存可以是任何類型的數據存儲，例如 IPFS 或 Arweave。blob 直接存在「外部硬碟」，因此儲存的數據不佔用主網區塊鏈的空間，可以減輕主網的負擔，降低 gas 費用。此外，blob 裡的數據是定期刪除的。這可以進一步減少 blob 儲存對主網的負擔。

最直接受益者就是 L2 ( $OP、 $ARB、 $METIS、 $STRK 等等)，L2 費用有望直接降 90%。
#### EIP-4844 的工作原理如下：

1. L2 將交易數據打包：第 2 層擴展解決方案 (L2) 可以處理許多交易。他們將這些交易分組為稱為 rollup 的區塊。 
2. rollup 哈希到主網路：L2 不會將整個 rollup 資料傳送到主以太坊網路。相反，它會計算 rollup 的唯一標識符（哈希值），並在常規交易中將其與一些附加資訊一起發送。 
3. 資料進入 Blob 儲存：實際的 rollup 資料儲存在稱為「Blob 儲存」的單獨空間中。這就像以太坊的“外部硬碟”，但它不是主區塊鏈的一部分。 
4. 主網驗證 Rollup：以太坊節點透過檢查交易中的雜湊值和資訊來驗證 Rollup 的有效性。他們不需要整個 rollup 資料本身。 
5. Blob 儲存管理資料：Blob 儲存負責將匯總資料保留一段時間。這些數據最終會被刪除以釋放空間。


#### EIP-4844 如何實現可擴充性?
- 降低 Gas 費用：透過以更便宜的價格儲存交易數據，EIP-4844 旨在降低以太坊的整體交易成本。 
- 更快的交易：隨著主網路堵塞的資料減少，交易處理時間預計會得到改善。


### 其他的一些升級

- EIP-1153：旨在節省鏈上資料儲存成本，有效利用區塊空間
- EIP-4788：尋求加強跨鏈橋和質押池的架構，增強安全性和功能性
- EIP-5656：建議對以太坊虛擬機器（EVM）進行微妙但重大的修改，以提高效能
- EIP-6780：提倡棄用 SELFDESTRUCT 函數，從而消除透過此程式碼終止智慧合約的能力
## 利好的幣種

可以去看 [l2beat](https://l2beat.com/scaling/summary) 上面會羅列出目前的 ETH L2 賽道的鏈，目前有發幣的是 Arbitrum One、Op、Starknet、Manta Network、Mantle、Metis、Aevo

淺在可以觀察的名單 Blast、zkSync、Linea